% -----------------------------------------------------------------
% Desenvolvido por Filipe Fernandes para o LIPES (Laboratório de Inovação, Pesquisa e Engenharia de Software)
% filipe.fernandes@ifsudestemg.edu.br
% ----------------------------------------------------------------
% Adaptado de Template Latex - Apresentação - UFMG
% https://www.overleaf.com/latex/templates/template-latex-apresentacao-ufmg/ygvvbrrsqgkv
% -----------------------------------------------------------------
% Licença Creative Commons CC BY 4.0
% -----------------------------------------------------------------
% PARA CORRER pdflatex -shell-escape main.tex
\documentclass[aspectratio=169,english]{beamer}

% a opção hideSubsectionTitle esconde o título das subseções
\usepackage{templateLIPES}      % o arquivo templateLIPES.sty possui todo o estilo de formatação
\usepackage[spanish]{babel}     % mude o idioma, caso necessite
\usepackage[alf, abnt-emphasize=bf, abnt-etal-text=it]{abntex2cite}

\setbeamertemplate{bibliography item}{}
\renewcommand{\theenumiv}{}

\begin{document}

\titulo{Incorporación de técnicas de muestreo mediante histogramas multidimensionales al código de
simulación de fuentes de Monte Carlo KDSource}
% \subtitulo{Subtítulo}       % caso não haja, comente

\autor{Lucas Ezequiel Ovando}
\orientador{Dr. Ariel Marquez}        % caso não haja, comente
\coorientador{Ing. Zoe Prieto}      % caso não haja, comente

\juradoA{Dr. Juan Carlos Losada}
\juradoB{Mg. Cuan Larlos Josada}

\curso{Ingenieria Nuclear}

\local{San Carlos de Bariloche, Rio Negro, Argentina}
\dia{17}
\mes{febrero}
\ano{2025}

% NÃO REMOVA!
\input{capa}

% CONTEÚDO -----------------------------------------------------------------

\section{Introdución}
\begin{frame}{Introdución}
    En este trabajo se planea incorporar una:
    \begin{itemize}
        \item tecnica de muestreo...
        \item ... mediante histogramas multidimensionales...
        \item ... al codigo de simulacion de fuentes Monte Carlo KDSource
    \end{itemize}
\end{frame}

\begin{frame}{Introdución: Tecnica de muestreo}
    \begin{figure}
        \centering
        \includegraphics[width=1\linewidth]{imagens/esquema1.jpeg}
        % \caption{1º seminário do LIPES em 27/01/2025}
        \label{fig:esquema1}
    \end{figure}

    Idea: a partir de una simulacion Monte Carlo donde se registran las particulas que atraviesan una superficie
    de registro se obtiene un surface track original. Luego se genera un surface track sintetico de mayor tamaño 
    para continuar la simulacion desde esa superficie en adelante.
\end{frame}

\begin{frame}{Introdución: Histogramas multidimensionales}
    \begin{figure}
        \centering
        \includegraphics[width=0.35\linewidth]{imagens/esquema2.jpeg}
        % \caption{1º seminário do LIPES em 27/01/2025}
        \label{fig:esquema2}
    \end{figure}

    Idea: realizar un histograma de la primer variable para luego subdividir la variable en macro grupos. Luego se 
    realiza subsiguientes histogramas de la siguiente variable para cada macro grupo. Se repite el proceso hasta formar
     un arbol de histogramas multidimensionales.

    Esto se realiza para poder obtener aproximaciones de la distribucion de probabilidad de las variables de interes mientras 
    se conserva la correlacion entre las variables.
\end{frame}

\begin{frame}{Introdución: Codigo de simulación de fuentes Monte Carlo KDSource}
    \begin{figure}
        \centering
        \includegraphics[width=0.35\linewidth]{imagens/esquema3.png}
        % \caption{1º seminário do LIPES em 27/01/2025}
        \label{fig:esquema3}
    \end{figure}

    Idea: KDSource es un codigo de simulacion de fuentes de Monte Carlo que se formulo en la tesis de maestria de 
    Inti Osiris Abbate para el codigo de fuente libre OpenMC. 
    
    El mismo actualmente permite simular fuentes de neutrones y fotones 
    a traves del metodo KDE. Se planea aprovechar la plataforma de KDSource para incorporar las tecnicas de muestreo
    mediante histogramas multidimensionales.
\end{frame}

\section{Motivación}
\begin{frame}{Motivación}
    % \begin{figure}
    %     \centering
    %     \includegraphics[width=0.6\linewidth]{imagens/1_seminario_LIPES.jpeg}
    %     % \caption{1º seminário do LIPES em 27/01/2025}
    %     \label{fig:1semlipes}
    % \end{figure}
    En problemas de transporte de radiación aplicados a calculo de blindajes y extraccion de 
    haces de neutrones se presenta la necesidad de obtener el flujo de radiacion a grandes 
    distancias del nucleo del reactor. Ademas, el calculo de blindajes trae el problema intrinseco 
    de querer obtener el flujo de radiacion en puntos donde se espera que haya bajo flujo.
    La forma de reducir el tiempo de calculo en estos problemas es la incorporacion de tecnicas de 
    reducción de varianza. Con estas es posible obtener tiempos razonables de simulación.
    
    Con este objetivo se plantea la incorporacion de tecnicas de muestreo mediante histogramas 
    multidimensionales al codigo de simulacion de fuentes de Monte Carlo KDSource.
\end{frame}

\section{Resultados preliminares}
\begin{frame}{Resultados preliminares}
    Avances hasta el momento:
    \begin{itemize}
        \item Interiorización del problema y de las tecnicas a incorporar
        \item Creación de un metodo para la aproximación de la distribucion de probabilidad de las variables de interes a traves de histogramas multidimensionales en Python. Por el momento requiere del usuario para la seleccion de parametros y funciona por fuera del codigo de KDSource. 
        \item Creación de un metodo para la generación de listas de particulas sinteticas a partir de los histogramas multidimensionales en Python. Por el momento falta traducirlo a C para incorporarlo al codigo de KDSource.
        \item Obtención de resultados preliminares en un ejemplo de simulacion de un canal de extraccion de neutrones.
        \item Todo el trabajo se ha realizado para neutrones, excluyendo los fotones.
    \end{itemize}
    % \begin{figure}
    %     \centering
    %     \includegraphics[width=0.6\linewidth]{imagens/1_seminario_LIPES.jpeg}
    %     % \caption{1º seminário do LIPES em 27/01/2025}
    %     \label{fig:1semlipes}
    % \end{figure}

\end{frame}

\begin{frame}[fragile]{Resultados preliminares: Histogramas multidimensionales}
    Histogramas macro:
    \begin{itemize}
        \item Permiten agrupar particulas segun su similutud por variables.
        \item En caso de tomar menos macrogrupos se obtiene mayor estadistica, a costa de perder correlacion entre variables.
        \item El usuario debe seleccionar la cantidad de macrogrupos, el orden del tratamiento de las variables y, de forma opcional, limites de macrogrupos manuales. Por ejemplo, limites geometricos del canal de extracción. 
    \end{itemize} 

    Input tipico:

    \begin{minted}[frame=single, linenos=false]{python}
    orden_columnas = ['letargia', 'x', 'y', 'mu', 'phi']
    macro_grupos = [6,5,5,4]
    \end{minted}

\end{frame}

\begin{frame}[fragile]{Resultados preliminares: Histogramas multidimensionales}
    Histogramas macro - Input tipico:

    \begin{minted}[frame=single, linenos=false]{python}
    orden_columnas = ['letargia', 'x', 'y', 'mu', 'phi']
    macro_grupos = [6,5,5,4]
    \end{minted}

    \begin{itemize}
        \item Se obtiene un histograma macro de 6 grupos en letargia
        \item Luego se obtienen un histograma macro de 5 grupos en x para cada grupo en letargia. En total 30 grupos en x.
        \item Luego se obtienen un histograma macro de 5 grupos en y para cada grupo en x. En total 150 grupos en y.
        \item Luego se obtienen un histograma macro de 4 grupos en mu para cada grupo en y. En total 600 grupos en mu.
        \item Total: 1 + 30 + 150 + 600 = 781 grupos macro en estructura de arbol.
    \end{itemize}

    Luego, para cada grupo macro se obtiene un histograma micro de la variable de interes. 

\end{frame}

\begin{frame}[fragile]{Resultados preliminares: Histogramas multidimensionales}
    Histogramas micro:

    \begin{itemize}
        \item Para cada macro grupo se obtiene un histograma micro de la variable de interes.
        \item A partir del histograma se normaliza y se obtiene la distribucion de frecuencia acumulada.
        \item La elección del numero de microgrupos es un compromiso entre obtener una buena aproximacion de la distribucion de probabilidad y no copiar el ruido estadistico.
    \end{itemize}

    A partir de este enfoque de macro y micro histogramas se logra aproximas la correlacion intrinseca entre las variables de interes.

    Luego es posible muestrear listas de particulas sinteticas a partir de los histogramas multidimensionales, utilizando numeros pseudoaleatorios y las funciones de frecuencia acumulada.

    % BORRADOR: tal vez poner dos esquemas de muchos y pocos micro bines. Sino ver que hacer para que no quede tan vacia
     

\end{frame}

\begin{frame}{Resultados preliminares: Muestreo de particulas}
    \begin{itemize}
        \item Para cada variable se genera un numero pseudoaleatorio entre 0 y 1 y se interpola la inversa de la funcion de frecuencia acumulada para obtener el valor de la variable. 
        \item Una vez obtenido el valor de la variable, se selecciona el macro grupo correspondiente y se obtiene la funcion de frecuencia acumulada correspondiente para la siguiente variable.
        \item Se repite el proceso hasta obtener todas las variables de interes.
        \item Se generan N particulas sinteticas y se exportan con formato .h5 para poder ser leidas como fuente por OpenMC.
        \item Se contrasta el resultado de la simulacion de la lista de particulas original y la lista de particulas sinteticas.
    \end{itemize}

\end{frame}

\begin{frame}{Resultados preliminares: Ejemplo de aplicacion}
    Por ultimo comentar el ejemplo de aplicacion que venimos trabajando y los resultados parciales que hemos obtenido. Entre ellos comentar diferencias entre incorporar o no los limites manuales de los macrogrupos (geometricos y en letargia). Ademas comentar diferencias entre diferente cantidad de micro y macrogrupos. Y tambien entre mayor o menor cantidad de particulas registradas.
    Ademas comentar del tubo de vacio y caracteristicas delticas de la fuente que estamos utilizando (delta en mu y en letargia).
    Ademas comentar que miramos el flujo a traves de la dimension de propagacion (total, agua y vacio) y que se observa el espectro al final del tubo (total, agua y vacio).

    

\end{frame}

\section{Conclusiones preliminares y trabajo futuro}

\begin{frame}{Conclusiones preliminares y trabajo futuro}

    BORRADOR:

    Comentar las caracteristicas delticas de la fuente que estamos utilizando (delta en mu y en letargia). Hablar sobre la ventaja de utilizar histogramsa en vez de gaussianas para seguir este tipo de fenomenos. Comentar que es relevante porque luego de un colimador el haz es bastante monodireccional. Ver de simular un caso real donde el haz no es 100\% monodireccional sino que tiene algun grado de dispersion.

    Hablar sobre la incorporracion de seleccion de parametros automaticos (tal vez decir que lo de la distancia KL).
    
    Hablar sobre la incorporacion a la API de KDSource el metodo de muestreo de particulas sinteticas.

    Hablar sobre la traduccion del muestreo a C y el acople on the fly.
    
    Aplicacion en el conducto N5 del RA6 para la simulacion del CHOPPPER.



\end{frame}

% \section{Código}
% \begin{frame}[fragile]{Código}
% \begin{minted}{python}
% from qiskit import QuantumRegister, QuantumCircuit
% from numpy import pi

% qreg_q = QuantumRegister(2, 'q')
% circuit = QuantumCircuit(qreg_q)

% circuit.h(qreg_q[0])
% circuit.cx(qreg_q[0], qreg_q[1])
% \end{minted}
% \end{frame}

% \section{Citação}
% \begin{frame}{Citação}
%     \begin{itemize}
%         \item De acordo com \citeonline{fernandes2017} ...
%         \item ... lorem ipsum \cite{fernandes2023}.
%     \end{itemize}
% \end{frame}

% FIM DO CONTEÚDO -----------------------------------------------------------------

% NÃO REMOVA!
\input{referencias}     
\end{document}